<!DOCTYPE html>
<html lang="mr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>üåü ‡§ö‡§Ç‡§™‡§æ‡§µ‡§§‡•Ä ‡§Æ‡•ã‡§π‡•ã‡§§‡•ç‡§∏‡§µ ‡§¨‡•Ä‡§° 2026 - ‡§∏‡•ç‡§™‡§∞‡•ç‡§ß‡§æ ‡§®‡•ã‡§Ç‡§¶‡§£‡•Ä (‡§®‡§µ‡•Ä‡§® ‡§Ü‡§µ‡•É‡§§‡•ç‡§§‡•Ä)</title>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Devanagari:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
:root {
--primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
--success-gradient: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
--error-color: #ef4444;
--warning-gradient: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
--glass-bg: rgba(255, 255, 255, 0.95);
--glass-border: rgba(255, 255, 255, 0.8);
--shadow-lg: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
--shadow-xl: 0 35px 60px -12px rgba(0, 0, 0, 0.3);
}

* { margin: 0; padding: 0; box-sizing: border-box; }

body {
font-family: 'Noto Sans Devanagari', sans-serif;
background: linear-gradient(135deg, #0f0f23 0%, #2d1b69 50%, #1a1a2e 100%);
min-height: 100vh;
position: relative;
overflow-x: hidden;
}

body::before {
content: '';
position: fixed;
top: 0; left: 0; right: 0; bottom: 0;
background-image: 
url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grain" width="100" height="100" patternUnits="userSpaceOnUse"><circle cx="25" cy="25" r="1" fill="%23ffffff" opacity="0.1"/><circle cx="75" cy="75" r="0.5" fill="%23ffffff" opacity="0.05"/><circle cx="50" cy="10" r="0.8" fill="%23ffffff" opacity="0.08"/></pattern></defs><rect width="100" height="100" fill="url(%23grain)"/></svg>'),
radial-gradient(circle at 20% 80%, rgba(120, 119, 198, 0.3) 0%, transparent 50%),
radial-gradient(circle at 80% 20%, rgba(255, 119, 198, 0.2) 0%, transparent 50%),
radial-gradient(circle at 40% 40%, rgba(120, 219, 255, 0.15) 0%, transparent 50%);
opacity: 0.5;
z-index: -1;
animation: bgFloat 20s ease-in-out infinite;
}

@keyframes bgFloat {
0%, 100% { transform: scale(1) rotate(0deg); }
50% { transform: scale(1.05) rotate(0.5deg); }
}

.container {
max-width: 900px;
margin: 0 auto;
padding: 20px;
min-height: 100vh;
display: flex;
flex-direction: column;
justify-content: center;
gap: 30px;
}

.hero-header {
background: var(--glass-bg);
backdrop-filter: blur(20px);
border-radius: 30px;
padding: 40px 30px;
text-align: center;
box-shadow: var(--shadow-xl);
border: 1px solid var(--glass-border);
position: relative;
overflow: hidden;
}

.hero-header::before {
content: '';
position: absolute;
top: -50%; left: -50%;
width: 200%; height: 200%;
background: var(--primary-gradient);
opacity: 0.1;
border-radius: 50%;
animation: heroGlow 6s ease-in-out infinite;
}

@keyframes heroGlow {
0%, 100% { transform: scale(1) rotate(0deg); opacity: 0.1; }
50% { transform: scale(1.2) rotate(180deg); opacity: 0.2; }
}

.logo-circle {
width: 180px; height: 180px;
margin: 0 auto 25px;
background: var(--primary-gradient);
border-radius: 50%;
display: flex;
flex-direction: column;
align-items: center;
justify-content: center;
color: white;
font-weight: 700;
font-size: 18px;
text-align: center;
box-shadow: 0 20px 40px rgba(102, 126, 234, 0.4);
position: relative;
}

.logo-circle::after {
content: 'üé≠';
font-size: 60px;
margin-bottom: 10px;
animation: logoPulse 2s ease-in-out infinite;
}

@keyframes logoPulse {
0%, 100% { transform: scale(1); }
50% { transform: scale(1.1); }
}

.main-title {
font-size: 36px;
font-weight: 700;
background: var(--primary-gradient);
-webkit-background-clip: text;
-webkit-text-fill-color: transparent;
background-clip: text;
margin-bottom: 10px;
line-height: 1.2;
}

.subtitle {
color: #64748b;
font-size: 20px;
font-weight: 500;
}

.registration-card {
background: var(--glass-bg);
backdrop-filter: blur(25px);
border-radius: 30px;
padding: 50px 40px;
box-shadow: var(--shadow-xl);
border: 1px solid var(--glass-border);
position: relative;
overflow: hidden;
max-height: 80vh;
overflow-y: auto;
}

.registration-card::before {
content: '';
position: absolute;
top: 0; left: 0; right: 0;
height: 5px;
background: var(--success-gradient);
box-shadow: 0 0 20px rgba(17, 153, 142, 0.5);
}

.form-title {
text-align: center;
color: #1e293b;
font-size: 28px;
font-weight: 700;
margin-bottom: 40px;
position: relative;
}

.form-title::after {
content: '';
position: absolute;
bottom: -15px;
left: 50%;
transform: translateX(-50%);
width: 80px;
height: 4px;
background: var(--success-gradient);
border-radius: 2px;
}

.form-grid {
display: grid;
grid-template-columns: 1fr 1fr;
gap: 25px;
margin-bottom: 30px;
}

.form-group {
margin-bottom: 25px;
}

.form-group.full-width { grid-column: 1 / -1; }

label {
display: block;
margin-bottom: 8px;
font-weight: 600;
color: #334155;
font-size: 15px;
}

.input-wrapper {
position: relative;
}

input, select, textarea {
width: 100%;
padding: 16px 20px;
border: 2px solid #e2e8f0;
border-radius: 16px;
font-size: 16px;
font-family: inherit;
background: rgba(255, 255, 255, 0.8);
backdrop-filter: blur(10px);
transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
}

input:focus, select:focus, textarea:focus {
outline: none;
border-color: #10b981;
box-shadow: 0 0 0 4px rgba(16, 185, 129, 0.1), 0 8px 25px rgba(16, 185, 129, 0.15);
transform: translateY(-2px);
background: white;
}

.required { color: var(--error-color); }

.error { 
border-color: var(--error-color) !important;
background: rgba(239, 68, 68, 0.05);
box-shadow: 0 0 0 3px rgba(239, 68, 68, 0.15) !important;
}

.error-message {
color: var(--error-color);
font-size: 13px;
margin-top: 6px;
display: none;
font-weight: 500;
animation: shake 0.5s ease-in-out;
}

@keyframes shake {
0%, 100% { transform: translateX(0); }
25% { transform: translateX(-4px); }
75% { transform: translateX(4px); }
}

.info-tip {
background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
border-left: 4px solid #f59e0b;
padding: 12px 16px;
border-radius: 10px;
font-size: 14px;
color: #92400e;
margin-top: 10px;
font-weight: 500;
}

.submit-section {
text-align: center;
padding-top: 30px;
border-top: 1px solid #e2e8f0;
}

.submit-btn {
width: 100%;
padding: 22px;
background: var(--success-gradient);
color: white;
border: none;
border-radius: 20px;
font-size: 20px;
font-weight: 700;
cursor: pointer;
text-transform: uppercase;
letter-spacing: 1px;
box-shadow: 0 12px 30px rgba(17, 153, 142, 0.4);
transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
position: relative;
overflow: hidden;
}

.submit-btn::before {
content: '';
position: absolute;
top: 0; left: -100%;
width: 100%; height: 100%;
background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
transition: left 0.5s;
}

.submit-btn:hover::before { left: 100%; }
.submit-btn:hover { 
transform: translateY(-4px);
box-shadow: 0 20px 40px rgba(17, 153, 142, 0.5);
}
.submit-btn:active { transform: translateY(-2px); }
.submit-btn:disabled { 
opacity: 0.7; 
cursor: not-allowed; 
transform: none;
}

.loading-spinner {
display: inline-block;
width: 24px; height: 24px;
border: 3px solid rgba(255,255,255,0.3);
border-top: 3px solid white;
border-radius: 50%;
animation: spin 1s linear infinite;
margin-right: 12px;
}

@keyframes spin { to { transform: rotate(360deg); } }

.counter-display {
text-align: center;
margin-top: 20px;
padding: 20px;
background: rgba(16, 185, 129, 0.1);
border-radius: 16px;
font-weight: 600;
color: #065f46;
}

.success-popup {
position: fixed;
top: 0; left: 0; right: 0; bottom: 0;
background: rgba(0, 0, 0, 0.6);
backdrop-filter: blur(15px);
display: none;
justify-content: center;
align-items: center;
z-index: 10000;
animation: fadeIn 0.3s ease;
}

.success-popup.show { display: flex; }

.success-card {
background: var(--glass-bg);
backdrop-filter: blur(30px);
border-radius: 30px;
padding: 60px 40px;
text-align: center;
max-width: 500px;
width: 90%;
max-height: 70vh;
overflow-y: auto;
box-shadow: var(--shadow-xl);
border: 2px solid var(--success-gradient);
transform: scale(0.8);
animation: popupScale 0.4s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
position: relative;
}

@keyframes popupScale {
to { transform: scale(1); }
}

.check-icon {
width: 100px; height: 100px;
background: var(--success-gradient);
border-radius: 50%;
margin: 0 auto 30px;
display: flex;
align-items: center;
justify-content: center;
font-size: 50px;
color: white;
box-shadow: 0 20px 40px rgba(17, 153, 142, 0.4);
animation: bounceIn 0.6s ease;
}

@keyframes bounceIn {
0% { transform: scale(0); }
50% { transform: scale(1.2); }
100% { transform: scale(1); }
}

.success-h1 { 
font-size: 32px; 
font-weight: 700; 
color: #059669;
margin-bottom: 15px;
}

.success-details {
color: #065f46;
font-size: 18px;
margin-bottom: 30px;
font-weight: 500;
}

.download-section {
background: rgba(16, 185, 129, 0.1);
padding: 30px;
border-radius: 20px;
margin: 25px 0;
}

.download-btn {
display: inline-flex;
align-items: center;
gap: 12px;
padding: 18px 35px;
background: var(--success-gradient);
color: white;
text-decoration: none;
border-radius: 16px;
font-size: 18px;
font-weight: 600;
box-shadow: 0 12px 30px rgba(17, 153, 142, 0.4);
transition: all 0.3s ease;
}

.download-btn:hover {
transform: translateY(-3px);
box-shadow: 0 18px 35px rgba(17, 153, 142, 0.5);
color: white;
}

.close-btn {
position: absolute;
top: 25px; right: 30px;
width: 45px; height: 45px;
background: rgba(239, 68, 68, 0.9);
color: white;
border: none;
border-radius: 50%;
font-size: 20px;
cursor: pointer;
display: flex;
align-items: center;
justify-content: center;
transition: all 0.3s ease;
}

.close-btn:hover { background: #dc2626; transform: scale(1.1); }

.live-stats {
display: grid;
grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
gap: 15px;
margin-top: 20px;
padding: 20px;
background: rgba(255, 255, 255, 0.1);
border-radius: 16px;
}

.stat-item {
text-align: center;
color: white;
font-weight: 600;
}

.stat-number { font-size: 24px; }

@media (max-width: 768px) {
.form-grid { grid-template-columns: 1fr; gap: 20px; }
.container { padding: 15px; }
.registration-card { padding: 40px 25px; margin: 10px; }
.main-title { font-size: 28px; }
}
</style>
</head>
<body>
<div class="container">
  <!-- ‡§π‡•Ä‡§∞‡•ã ‡§π‡•á‡§°‡§∞ -->
  <div class="hero-header">
    <div class="logo-circle">
      ‡§ö‡§Ç‡§™‡§æ‡§µ‡§§‡•Ä<br>‡§Æ‡•ã‡§π‡•ã‡§§‡•ç‡§∏‡§µ 2026
    </div>
    <div class="main-title">‡§∏‡•ç‡§™‡§∞‡•ç‡§ß‡§æ ‡§®‡•ã‡§Ç‡§¶‡§£‡•Ä</div>
    <div class="subtitle">‡§¨‡•Ä‡§° | ‡§Æ‡§π‡§æ‡§∞‡§æ‡§∑‡•ç‡§ü‡•ç‡§∞ | ‡•®‡•¶‡•®‡•¨</div>
  </div>

  <!-- ‡§Æ‡•Å‡§ñ‡•ç‡§Ø ‡§®‡•ã‡§Ç‡§¶‡§£‡•Ä ‡§´‡•â‡§∞‡•ç‡§Æ -->
  <div class="registration-card">
    <h2 class="form-title">‡§∏‡•ç‡§™‡§∞‡•ç‡§ß‡§æ ‡§®‡•ã‡§Ç‡§¶‡§£‡•Ä ‡§´‡•â‡§∞‡•ç‡§Æ</h2>
    
    <form id="champawatiForm" novalidate>
      <div class="form-grid">
        <div class="form-group">
          <label for="schoolName">üè´ ‡§∂‡§æ‡§≥‡•á‡§ö‡•á ‡§®‡§æ‡§µ <span class="required">*</span></label>
          <div class="input-wrapper">
            <input type="text" id="schoolName" name="schoolName" required maxlength="100">
            <div class="error-message" id="schoolNameError">‡§∂‡§æ‡§≥‡•á‡§ö‡•á ‡§®‡§æ‡§µ ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï ‡§Ü‡§π‡•á</div>
          </div>
        </div>

        <div class="form-group">
          <label for="competition">üé≠ ‡§∏‡•ç‡§™‡§∞‡•ç‡§ß‡§æ <span class="required">*</span></label>
          <div class="input-wrapper">
            <select id="competition" name="competition" required>
              <option value="">‡§∏‡•ç‡§™‡§∞‡•ç‡§ß‡§æ ‡§®‡§ø‡§µ‡§°‡§æ</option>
              <option value="dance">üíÉ ‡§®‡•É‡§§‡•ç‡§Ø ‡§∏‡•ç‡§™‡§∞‡•ç‡§ß‡§æ</option>
              <option value="solo_drama">üé≠ ‡§è‡§ï‡§™‡§æ‡§§‡•ç‡§∞‡•Ä ‡§Ö‡§≠‡§ø‡§®‡§Ø</option>
              <option value="singing">üé§ ‡§ó‡•Ä‡§§ ‡§ó‡§æ‡§Ø‡§®</option>
              <option value="painting">üñåÔ∏è ‡§ö‡§ø‡§§‡•ç‡§∞‡§ï‡§≤‡§æ</option>
              <option value="rangoli">üå∫ ‡§∞‡§æ‡§Ç‡§ó‡•ã‡§≥‡•Ä</option>
            </select>
            <div class="error-message" id="competitionError">‡§∏‡•ç‡§™‡§∞‡•ç‡§ß‡§æ ‡§®‡§ø‡§µ‡§°‡§æ</div>
          </div>
        </div>
      </div>

      <!-- ‡§ï‡§Ç‡§°‡§ø‡§∂‡§®‡§≤ ‡§´‡•Ä‡§≤‡•ç‡§°‡•ç‡§∏ -->
      <div class="form-group full-width" id="danceGroup" style="display: none;">
        <label for="danceType">üíÉ ‡§®‡•É‡§§‡•ç‡§Ø ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞ <span class="required" id="danceReq">*</span></label>
        <select id="danceType" name="danceType">
          <option value="">‡§™‡•ç‡§∞‡§ï‡§æ‡§∞ ‡§®‡§ø‡§µ‡§°‡§æ</option>
          <option value="solo">‡§∏‡•ã‡§≤‡•ã ‡§®‡•É‡§§‡•ç‡§Ø</option>
          <option value="duet">‡§ú‡•ã‡§°‡•Ä‡§®‡•É‡§§‡•ç‡§Ø</option>
          <option value="group">‡§ó‡•ç‡§∞‡•Å‡§™ ‡§®‡•É‡§§‡•ç‡§Ø</option>
          <option value="family">üë®‚Äçüë©‚Äçüëß‚Äçüë¶ ‡§ï‡•Å‡§ü‡•Å‡§Ç‡§¨ ‡§®‡•É‡§§‡•ç‡§Ø</option>
        </select>
        <div class="error-message" id="danceTypeError">‡§®‡•É‡§§‡•ç‡§Ø ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞ ‡§®‡§ø‡§µ‡§°‡§æ</div>
      </div>

      <div class="form-group full-width" id="ageGroupField" style="display: none;">
        <label for="ageGroup">üìö ‡§µ‡§Ø‡•ã‡§ó‡§ü <span class="required" id="ageReq">*</span></label>
        <select id="ageGroup" name="ageGroup">
          <option value="">‡§µ‡§Ø‡•ã‡§ó‡§ü ‡§®‡§ø‡§µ‡§°‡§æ</option>
          <option value="1-3">‡§á. 1‡§≤‡•Ä ‡§§‡•á 3‡§∞‡•Ä</option>
          <option value="4-6">‡§á. 4‡§•‡•Ä ‡§§‡•á 6‡§µ‡•Ä</option>
          <option value="7-10">‡§á. 7‡§µ‡•Ä ‡§§‡•á 10‡§µ‡•Ä</option>
        </select>
        <div class="error-message" id="ageGroupError">‡§µ‡§Ø‡•ã‡§ó‡§ü ‡§®‡§ø‡§µ‡§°‡§æ</div>
      </div>

      <div class="form-group full-width" id="songField" style="display: none;">
        <label for="songLyrics">üéµ ‡§ó‡§æ‡§£‡•ç‡§Ø‡§æ‡§ö‡•á ‡§¨‡•ã‡§≤ <span class="required" id="songReq">*</span></label>
        <textarea id="songLyrics" name="songLyrics" rows="3" maxlength="500" 
                  placeholder="‡§ó‡§æ‡§£‡•ç‡§Ø‡§æ‡§ö‡•á ‡§™‡•Ç‡§∞‡•ç‡§£ ‡§¨‡•ã‡§≤ ‡§á‡§•‡•á ‡§ü‡§æ‡§ï‡§æ... (500 ‡§Ö‡§ï‡•ç‡§∑‡§∞‡§æ‡§Ç‡§™‡§∞‡•ç‡§Ø‡§Ç‡§§)"></textarea>
        <div class="error-message" id="songLyricsError">‡§ó‡§æ‡§£‡•ç‡§Ø‡§æ‡§ö‡•á ‡§¨‡•ã‡§≤ ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï ‡§Ü‡§π‡•á‡§§</div>
      </div>

      <div class="form-group full-width">
        <label for="participantName">üë§ ‡§∏‡•ç‡§™‡§∞‡•ç‡§ß‡§ï ‡§®‡§æ‡§µ <span class="required">*</span></label>
        <div class="input-wrapper">
          <input type="text" id="participantName" name="participantName" required maxlength="150">
          <div class="info-tip">
            üë• ‡§ú‡•ã‡§°‡•Ä‡§®‡•É‡§§‡•ç‡§Ø/‡§ï‡•Å‡§ü‡•Å‡§Ç‡§¨ ‡§®‡•É‡§§‡•ç‡§Ø‡§æ‡§∏‡§æ‡§†‡•Ä: "‡§∞‡§æ‡§π‡•Å‡§≤ ‡§µ ‡§™‡•ç‡§∞‡§ø‡§Ø‡§æ" ‡§Ö‡§∏‡§æ ‡§â‡§≤‡•ç‡§≤‡•á‡§ñ ‡§ï‡§∞‡§æ
          </div>
          <div class="error-message" id="participantNameError">‡§∏‡•ç‡§™‡§∞‡•ç‡§ß‡§ï‡§æ‡§ö‡•á ‡§™‡•Ç‡§∞‡•ç‡§£ ‡§®‡§æ‡§µ ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï ‡§Ü‡§π‡•á</div>
        </div>
      </div>

      <div class="form-group full-width">
        <label for="participantPhone">üì± ‡§∏‡§Ç‡§™‡§∞‡•ç‡§ï ‡§ï‡•ç‡§∞‡§Æ‡§æ‡§Ç‡§ï <span class="required">*</span></label>
        <div class="input-wrapper">
          <input type="tel" id="participantPhone" name="participantPhone" 
                 maxlength="10" pattern="[0-9]{10}" required>
          <div class="error-message" id="participantPhoneError">10 ‡§Ö‡§Ç‡§ï‡•Ä ‡§Æ‡•ã‡§¨‡§æ‡§à‡§≤ ‡§ï‡•ç‡§∞‡§Æ‡§æ‡§Ç‡§ï ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï</div>
        </div>
      </div>

      <div class="submit-section">
        <button type="submit" class="submit-btn" id="submitBtn">
          üöÄ ‡§®‡•ã‡§Ç‡§¶‡§£‡•Ä ‡§®‡•ã‡§Ç‡§¶‡§µ‡§æ
        </button>
        <div id="loadingSpinner" class="loading-spinner" style="display: none;"></div>
      </div>
    </form>

    <!-- ‡§≤‡§æ‡§à‡§µ‡•ç‡§π ‡§∏‡•ç‡§ü‡•Ö‡§ü‡•ç‡§∏ -->
    <div class="live-stats" id="liveStats" style="display: none;">
      <div class="stat-item">
        <div class="stat-number" id="totalCount">0</div>
        <div>‡§è‡§ï‡•Ç‡§£ ‡§®‡•ã‡§Ç‡§¶‡§£‡•ç‡§Ø‡§æ</div>
      </div>
    </div>
  </div>
</div>

<!-- ‡§Ø‡§∂‡§∏‡•ç‡§µ‡•Ä ‡§™‡•â‡§™‡§Ö‡§™ -->
<div id="successModal" class="success-popup">
  <div class="success-card">
    <button class="close-btn" onclick="closeSuccessModal()">&times;</button>
    
    <div class="check-icon">‚úÖ</div>
    
    <h1 class="success-h1" id="successMsg">‡§®‡•ã‡§Ç‡§¶‡§£‡•Ä ‡§Ø‡§∂‡§∏‡•ç‡§µ‡•Ä!</h1>
    <div class="success-details" id="successDetails">‡§Ü‡§™‡§≤‡•Ä ‡§®‡•ã‡§Ç‡§¶‡§£‡•Ä ‡§Ø‡§∂‡§∏‡•ç‡§µ‡•Ä‡§™‡§£‡•á ‡§™‡•Ç‡§∞‡•ç‡§£ ‡§ù‡§æ‡§≤‡•Ä ‡§Ü‡§π‡•á</div>
    
    <div class="download-section">
      <a href="#" class="download-btn" id="rulesDownload" download>
        üìÑ ‡§®‡§ø‡§Ø‡§Æ‡§æ‡§µ‡§≤‡•Ä ‡§°‡§æ‡§â‡§®‡§≤‡•ã‡§°
      </a>
    </div>
    
    <div style="margin-top: 25px; font-size: 14px; color: #64748b;">
      ‡§®‡•ã‡§Ç‡§¶‡§£‡•Ä‡§∏‡§æ‡§†‡•Ä ‡§ß‡§®‡•ç‡§Ø‡§µ‡§æ‡§¶! üéâ
    </div>
  </div>
</div>

<script>
const GAS_URL = 'https://script.google.com/macros/s/AKfycbyD_5poskIyKhfPLIPiyR5YNjZ3Av0VzencZd89HBMoL4wIGTecANE1Mr5n209QzNWAlg/exec';
let totalRegistrations = 0;

// üî• ‡§™‡§∞‡§´‡•á‡§ï‡•ç‡§ü ‡§´‡•â‡§∞‡•ç‡§Æ ‡§µ‡•ç‡§π‡•Ö‡§≤‡§ø‡§°‡•á‡§∂‡§® + GAS ‡§á‡§Ç‡§ü‡§ø‡§ó‡•ç‡§∞‡•á‡§∂‡§®
document.getElementById('champawatiForm').addEventListener('submit', async (e) => {
  e.preventDefault();
  
  if (!validateForm()) return;
  
  const submitBtn = document.getElementById('submitBtn');
  const spinner = document.getElementById('loadingSpinner');
  const originalText = submitBtn.innerHTML;
  
  submitBtn.disabled = true;
  spinner.style.display = 'inline-block';
  submitBtn.innerHTML = '<div class="loading-spinner"></div> ‡§∏‡•á‡§µ ‡§π‡•ã‡§§ ‡§Ü‡§π‡•á...';
  
  try {
    const formData = collectFormData();
    const response = await fetch(GAS_URL, {
      method: 'POST',
      mode: 'no-cors', // GAS CORS workaround
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(formData)
    });
    
    // Simulate success (no-cors prevents reading response)
    await new Promise(resolve => setTimeout(resolve, 1500));
    
    showSuccessModal(formData);
    document.getElementById('champawatiForm').reset();
    loadStats();
    
  } catch (error) {
    console.error('Error:', error);
    alert('‡§ï‡•É‡§™‡§Ø‡§æ ‡§™‡•Å‡§®‡•ç‡§π‡§æ ‡§™‡•ç‡§∞‡§Ø‡§§‡•ç‡§® ‡§ï‡§∞‡§æ ‡§ï‡§ø‡§Ç‡§µ‡§æ admin@champawati2026.in ‡§µ‡§∞ ‡§∏‡§Ç‡§™‡§∞‡•ç‡§ï ‡§∏‡§æ‡§ß‡§æ');
  } finally {
    submitBtn.disabled = false;
    spinner.style.display = 'none';
    submitBtn.innerHTML = originalText;
  }
});

// üöÄ ‡§∏‡•ç‡§Æ‡§æ‡§∞‡•ç‡§ü ‡§µ‡•ç‡§π‡•Ö‡§≤‡§ø‡§°‡•á‡§∂‡§®
function validateForm() {
  let isValid = true;
  const fields = ['schoolName', 'competition', 'participantName', 'participantPhone'];
  
  // Dynamic validation based on competition
  const comp = document.getElementById('competition').value;
  if (comp === 'dance') fields.push('danceType');
  if (['dance', 'singing', 'solo_drama', 'painting'].includes(comp)) fields.push('ageGroup');
  if (['dance', 'singing'].includes(comp)) fields.push('songLyrics');
  
  fields.forEach(fieldId => {
    const field = document.getElementById(fieldId);
    const error = document.getElementById(fieldId + 'Error');
    if (field.required && !field.value.trim()) {
      field.classList.add('error');
      error.style.display = 'block';
      isValid = false;
    } else {
      field.classList.remove('error');
      error.style.display = 'none';
    }
  });
  
  // Phone validation
  const phone = document.getElementById('participantPhone').value;
  if (phone && !/^\d{10}$/.test(phone)) {
    document.getElementById('participantPhone').classList.add('error');
    document.getElementById('participantPhoneError').style.display = 'block';
    isValid = false;
  }
  
  return isValid;
}

// üìä ‡§°‡•á‡§ü‡§æ ‡§ï‡§≤‡•á‡§ï‡•ç‡§∂‡§®
function collectFormData() {
  const data = {};
  new FormData(document.getElementById('champawatiForm')).forEach((value, key) => {
    data[key] = value;
  });
  data.timestamp = new Date().toLocaleString('mr-IN');
  data.registrationId = 'CHM' + Date.now().toString().slice(-6);
  return data;
}

// üé≠ ‡§ï‡§Ç‡§°‡§ø‡§∂‡§®‡§≤ ‡§´‡•Ä‡§≤‡•ç‡§°‡•ç‡§∏
document.getElementById('competition').addEventListener('change', function() {
  const val = this.value;
  toggleField('danceGroup', val === 'dance');
  toggleField('ageGroupField', ['dance','singing','solo_drama','painting'].includes(val));
  toggleField('songField', ['dance','singing'].includes(val));
  
  function toggleField(id, show) {
    const field = document.getElementById(id);
    const reqSpan = field.querySelector('.required');
    field.style.display = show ? 'block' : 'none';
    if (reqSpan) reqSpan.dataset.required = show;
    const select = field.querySelector('select, textarea');
    if (select) select.required = show;
  }
});

// Phone auto-format
document.getElementById('participantPhone').addEventListener('input', function() {
  this.value = this.value.replace(/[^0-9]/g, '').slice(0, 10);
});

// üéâ Success Modal
function showSuccessModal(data) {
  document.getElementById('successMsg').textContent = `‡§®‡•ã‡§Ç‡§¶‡§£‡•Ä #${data.registrationId} ‡§Ø‡§∂‡§∏‡•ç‡§µ‡•Ä!`;
  document.getElementById('successDetails').textContent = `${data.participantName} ‡§ö‡•Ä ${data.competition === 'dance' ? '‡§®‡•É‡§§‡•ç‡§Ø' : data.competition} ‡§∏‡•ç‡§™‡§∞‡•ç‡§ß‡•á‡§∏‡§æ‡§†‡•Ä ‡§®‡•ã‡§Ç‡§¶‡§£‡•Ä ‡§ù‡§æ‡§≤‡•Ä.`;
  document.getElementById('successModal').classList.add('show');
  document.body.style.overflow = 'hidden';
}

function closeSuccessModal() {
  document.getElementById('successModal').classList.remove('show');
  document.body.style.overflow = 'auto';
}

// üåê Global click handlers
document.getElementById('successModal').addEventListener('click', (e) => {
  if (e.target.classList.contains('success-popup')) closeSuccessModal();
});

// Real-time validation
document.querySelectorAll('input, select, textarea').forEach(el => {
  el.addEventListener('blur', () => validateForm());
});

// üìà Load stats (mock - replace with real API)
async function loadStats() {
  // Simulate API call
  totalRegistrations = Math.floor(Math.random() * 150) + 50;
  document.getElementById('totalCount').textContent = totalRegistrations;
  document.getElementById('liveStats').style.display = 'grid';
}

// Initialize
loadStats();
setInterval(loadStats, 30000); // Refresh every 30s
</script>
</body>
</html>
